@model Interext.Models.EventViewModel

@{
    ViewBag.Title = "Details";
}

@section CssStyles{
    @Styles.Render("~/Content/eventPageCss")
}


@*<div id="single-page">*@
<div>
    <div id="content" class="right-sidebar">
        <div class="event-page-content">
            <article>
                <div class="event-intro-wrapper" style="background-image: url('@Model.ImageUrl');">
                    <div class="event-intro">
                        <h1 class="event-title">
                            @Model.Title
                        </h1>
                        <div class="event-date">
                            <div>
                                @Model.DateOfTheEventNoYear
                            </div>
                            <div class="event-time">
                                <span class="fa fa-clock-o"></span> @Model.DateTimeOfTheEvent.Hour.@Model.DateTimeOfTheEvent.Minute
                            </div>
                            <div class="event-location">
                                <span class="fa fa-map-marker"></span>&nbsp;@Model.Place<br />
                            </div>
                        </div>
                        <div class="clear"></div>
                        <div class="event-details">

                            <a href="/Account/Details?id=@Model.CreatorUser.Id">
                                <div class="createdby">Created by</div> <img src="@Model.CreatorUser.ImageUrl" />
                                <div class="creator-name">@Model.CreatorUser.FirstName @Model.CreatorUser.LastName</div>
                            </a>
                            <div class="clear"></div>
                        </div>
                        <table class="event-restrictions">
                            <tr>
                                <td>Ages</td>
                                <td>
                                    @Model.AgeOfParticipantsMin@if (Model.AgeOfParticipantsMax != null)
                                    {<span>-</span>@Model.AgeOfParticipantsMax}
                                    else
                                    {<span>+</span>}
                                </td>
                            </tr>
                            <tr>
                                <td>Number Of Participants</td>
                                <td>
                                    @Model.NumOfParticipantsMin@if (Model.NumOfParticipantsMax != null)
                                    {<span>-</span>@Model.NumOfParticipantsMax}
                                    else
                                    {<span>+</span>}
                                </td>
                            </tr>
                            @if (Model.GenderParticipant != "Both")
                            {
                                <tr><td>Gender</td><td>@Model.GenderParticipant</td></tr>
                            }
                            <tr>
                                <td>Interests</td>
                                <td>
                                    @Model.InterestsToDisplay
                                </td>
                            </tr>
                        </table>
                        <div class="clear"></div>
                    </div>
                </div>
                <div class="event-desc">
                    <p>@Model.Description</p>

                    <h3>ATTENDERS:</h3>
                    <div class="ozy-latest-posts">
                        @foreach (var item in Model.UsersAttending)
                        {
                            <a href="/Account/Details?id=@item.Id" title="@item.FirstName @item.LastName" style="background-image:url('@item.ImageUrl')"></a>
                        }

                        @*<a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event1.jpg')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event2.jpg')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event3.jpg')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event4.png')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event5.jpg')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event6.jpg')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event7.jpg')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event8.jpg')"></a>
                            <a href="/Event/Details?id=1" title="Arizona Muse" style="background-image:url('/Content/images/example-images/event9.jpg')"></a>*@
                    </div>
                </div>
            </article>
        </div>
        <div class="clear"></div>

    </div><!--#content-->

    <div id="sidebar" class="right-sidebar">
        <ul>
            <li>
                @if (Model.CurrentUserIsCreator)
                {
                    @Html.ActionLink("Edit the Event", "Edit", new { Id = ViewData["Id"], model = Model }, new { @class = "side-bar-button btn btn-dark" })

                }
                else
                {
                    if (bool.Parse(ViewData["UserAlreadyAttending"].ToString()))
                    {
                        using (Ajax.BeginForm("UnjoinEvent", new { Id = ViewData["Id"] }, new AjaxOptions { HttpMethod = "Get", OnFailure = "onJoinEventFailure", OnSuccess = "onJoinEventSuccess" }, new { id = "unjoinEventForm" }))
                        {
                            @*@Html.ActionLink("+Join the Event", "JoinEvent", new { Id = ViewData["Id"] }, new { @class = "side-bar-button btn btn-dark" })*@
                            <input type="submit" class="side-bar-button btn btn-dark" value="Leave event" />
                        }
                    }
                    else
                    {
                        using (Ajax.BeginForm("JoinEvent", new { Id = ViewData["Id"] }, new AjaxOptions { HttpMethod = "Get", OnFailure = "onJoinEventFailure", OnSuccess = "onJoinEventSuccess" }, new { id = "joinEventForm" }))
                        {
                            <input type="submit" class="side-bar-button btn btn-dark" value="+Join event" />
                        }
                    }
                }

            </li>
            <li class="widget">
                <h3>ATTENDERS STATISTICS:</h3>
                <input type="hidden" id="hidStatisticValues" value="@ViewData["statistics"]" />
                <div id="canvas-holder-gender">
                    <h4>Gender:</h4>
                    <canvas id="chart-area-gender" width="300" height="300" />
                </div>
                <div id="canvas-holder-age">
                    <h4>Age:</h4>
                    <canvas id="chart-area-age" width="300" height="300" />
                </div>
                <div class="clear"></div>
                <div id="canvas-holder-interests">
                    <h4>Interests:</h4>
                    <canvas id="chart-area-interests" width="300" height="300" />
                </div>
            </li>
            @if (Model.CurrentUserIsCreator)
            {
                <li>
                    @using (Ajax.BeginForm("Delete", new { Id = ViewData["Id"] }, new AjaxOptions { HttpMethod = "Get", OnFailure = "onDeleteEventFailure", OnSuccess = "onDeleteEventSuccess" }, new { id = "deleteEventForm" }))
                    {
                        <input type="submit" class="side-bar-button btn btn-dark" value="Cancel Event" />
                    }
                </li>
            }
            <li>
                @using (Ajax.BeginForm("Report", "Home", new { Id = ViewData["Id"] },
                    new AjaxOptions
                    {
                HttpMethod = "Get",
                InsertionMode = InsertionMode.Replace,
                UpdateTargetId = "target",
                OnFailure = "onReportEventFailure",
                OnSuccess = "onReportEventSuccess"
                    }))
                {
                    <input type="submit" class="side-bar-button btn btn-dark" value="Report Event" />
                }
            </li>
        </ul>
    </div>
    <!--sidebar-->
    <div class="clear"></div>


</div>

<div id="dialog-confirm" title="Cancel the event?">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>The event will be permanently deleted and cannot be recovered. Are you sure?</p>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/eventDetailsJs")
}
